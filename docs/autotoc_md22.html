<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BOSS Afterburner: Setup of your BOSS environment</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BOSS Afterburner
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('autotoc_md22.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Setup of your BOSS environment </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>***Note:** In it's current version, this tutorial assumes you use a <code>bash</code> terminal.*</p>
<p>I advise you to set up your environment in the same way I did. There are two main directories that you will be using: (1) the <em>work area</em> that contains your run scripts for <b>BOSS</b> and (2) the <em>BOSS Afterburner</em> repository. I placed the work area in my <code>ihepbatch</code> folder (see <a class="el" href="ihep-server_8md.html">Organisation of the IHEP server</a>) and the BOSS Afterburner in my <code>besfs</code> folder. Data generated with <b>BOSS</b> through the work area scripts is written then to the <code>BOSS_Afterburner/data</code> directory on <code>besfs</code> (see later).</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000007">Todo:</a></b></dt><dd><p class="startdd">Test the procedure described below! </p>
<p class="enddd">Rewrite for TC shell.</p>
</dd></dl>
<p>You will be running your <b>BOSS</b> analyses from this folder. It contains a <em>Configuration Management Tool</em> folder (<code>cmthome</code>), which is used to set up path variables for <b>BOSS</b>, and a <code>workarea</code> folder where you develop your own <b>BOSS</b> packages (including the <code>jobOptions*.txt</code> files).</p>
<h3>**Step 1:** Go to your <em>IHEP batch</em> folder</h3>
<div class="fragment"><div class="line">cd /ihepbatch/bes/$USER</div></div><!-- fragment --><p>At this stage, you'll have to decide which version of BOSS you have to use. At the time of writing, version 7.0.3 is the latest stable version, though it could be that for your analysis you have to use data sets that were reconstructed with older versions of <b>BOSS</b>. Here, I'll just use <code>7.0.3</code>, but you can replace this number with whatever version you need.</p>
<h3>**Step 2: Configure the environment**</h3>
<p>We'll first set up the necessary references to <b>BOSS</b> using the <em>Configuration Management Tool</em> (CMT). This is done by copying the <code>cmthome</code> folder from BOSS Software directory to the <code>ihepbatch</code> folder where you currently are:</p>
<div class="fragment"><div class="line">cp -R /afs/ihep.ac.cn/bes3/offline/Boss/cmthome/cmthome-7.0.3 .</div></div><!-- fragment --><p>and navigate into that copy:</p>
<div class="fragment"><div class="line">cd cmthome-7.0.3</div></div><!-- fragment --><h3>**Step 3: Modify <code>requirements</code>**</h3>
<p>You'll now have to modify the file called <code>requirements</code> so that it handles your username properly. We'll use the <code>vi</code> editor here, but you can use whatever editor you prefer:</p>
<div class="fragment"><div class="line">vi requirements</div></div><!-- fragment --><p>The file contains the following lines:</p>
<div class="fragment"><div class="line">#macro WorkArea &quot;/ihepbatch/bes/maqm/workarea&quot;</div><div class="line"></div><div class="line">#path_remove CMTPATH &quot;${WorkArea}&quot;</div><div class="line">#path_prepend CMTPATH &quot;${WorkArea}&quot;</div></div><!-- fragment --><p>Uncomment them (remove the hash <code>#</code>) and replace <code>maqm</code> with your own user name. Like this:</p>
<div class="fragment"><div class="line">macro WorkArea &quot;/ihepbatch/bes/$USER/workarea&quot;</div><div class="line"></div><div class="line">path_remove CMTPATH &quot;${WorkArea}&quot;</div><div class="line">path_prepend CMTPATH &quot;${WorkArea}&quot;</div></div><!-- fragment --><h3>**Step 4: Set references to BOSS**</h3>
<p>Now you can use the scripts to set all references to <b>BOSS</b> at once using:</p>
<div class="fragment"><div class="line">source setupCMT.sh  # starts connection to the CMT</div><div class="line">cmt config          # initiates configuration</div><div class="line">source setup.sh     # sets path variables</div></div><!-- fragment --><p>Just to be sure, you can check whether the path variables have been set correctly:</p>
<div class="fragment"><div class="line">echo $CMTPATH</div></div><!-- fragment --><p>If everything went well, it should print:</p>
<div class="fragment"><div class="line">/ihepbatch/bes/$USER/workarea-7.0.3:/afs/ihep.ac.cn/bes3/offline/Boss/7.0.3:/afs/ihep.ac.cn/bes3/offline/ExternalLib/SLC6/ExternalLib/gaudi/GAUDI_v23r9:/afs/ihep.ac.cn/bes3/offline/ExternalLib/SLC6/ExternalLib/LCGCMT/LCGCMT_65a</div></div><!-- fragment --><h3>**Step 5: Modify your <code>bashrc</code>**</h3>
<p>Adapt your <code>bash</code> profile (<code>.bash_profile</code>) and <em>run commands</em> file (<code>.bashrc</code>) so that <b>BOSS</b> is loaded automatically every time you log into the server. The easy solution is simply copy-pasting and running these commands:</p>
<div class="fragment"><div class="line">echo -e &quot;if test -f .bashrc; then\n\tsource .bashrc\nfi&quot; &gt;&gt; ~/.bash_profile</div><div class="line">echo &quot;IHEPBATCH=\&quot;/ihepbatch/bes/$USER\&quot;&quot; &gt;&gt; ~/.bashrc</div><div class="line">echo &quot;CMTHOME=\&quot;/afs/ihep.ac.cn/bes3/offline/Boss/cmthome/cmthome-7.0.3\&quot;&quot; &gt;&gt; ~/.bashrc</div><div class="line">echo &quot;source $IHEPBATCH/cmthome-7.0.3/setupCMT.sh&quot; &gt;&gt; ~/.bashrc</div><div class="line">echo &quot;source $IHEPBATCH/cmthome-7.0.3/setup.sh&quot; &gt;&gt; ~/.bashrc</div><div class="line">echo &quot;source $IHEPBATCH/workarea-7.0.3/TestRelease/TestRelease-00-00-86/cmt/setup.sh&quot; &gt;&gt; ~/.bashrc</div><div class="line">echo &quot;export PATH=$PATH:/afs/ihep.ac.cn/soft/common/sysgroup/hep_job/bin/&quot; &gt;&gt; ~/.bashrc</div></div><!-- fragment --><p>However, to avoid becoming a <a href="https://pics.me.me/kakashi-went-from-the-copy-ninja-to-the-copy-paste-14969048.png">copy ninja</a>, you'd better modify these files yourself. First, add these lines to your bash profile (<code>vi ~/bash_profile</code>):</p>
<div class="fragment"><div class="line">if test -f .bashrc; then</div><div class="line">    source .bashrc</div><div class="line">fi</div></div><!-- fragment --><p>These lines force the server to load your <code>.bashrc</code> run commands file. In that file, you should add the following lines:</p>
<div class="fragment"><div class="line">IHEPBATCH=&quot;/ihepbatch/bes/$USER&quot;</div><div class="line">CMTHOME=&quot;/afs/ihep.ac.cn/bes3/offline/Boss/cmthome/cmthome-7.0.3&quot;</div><div class="line">source $IHEPBATCH/cmthome-7.0.3/setupCMT.sh</div><div class="line">source $IHEPBATCH/cmthome-7.0.3/setup.sh</div><div class="line">source $IHEPBATCH/workarea-7.0.3/TestRelease/TestRelease-00-00-86/cmt/setup.sh</div><div class="line">export PATH=$PATH:/afs/ihep.ac.cn/soft/common/sysgroup/hep_job/bin/</div></div><!-- fragment --><p>Notice that the commands we used in step 4 are used here again. There is also a reference to the <code>workarea</code> (see step 7). The last line allows you to submit <b>BOSS</b> jobs to the queue&mdash;for now, don't worry what this means.</p>
<p>You can now either log in again to the server or use <code>source ~/.bashrc</code> to reload the run commands.</p>
<h3>**Step 6: Test it <code>boss.exe</code>**</h3>
<p>To test whether everything went correctly, you can try to run <b>BOSS</b>:</p>
<div class="fragment"><div class="line">boss.exe</div></div><!-- fragment --><p>It should result in a (trivial) error message like this:</p>
<div class="fragment"><div class="line">               BOSS version: 7.0.3</div><div class="line">************** BESIII Collaboration **************</div><div class="line"></div><div class="line">the jobOptions file is : jobOptions.txt</div><div class="line">ERROR! the jobOptions file is empty!</div></div><!-- fragment --><h3>**Step 7: Create your** <em><b>workarea</b></em></h3>
<p>It is convention to place your <b>BOSS</b> packages in a <em>workarea</em> folder next to the <code>cmthome</code> folder we have been using so far. Let's create it:</p>
<div class="fragment"><div class="line">cd /ihepbatch/bes/$USER</div><div class="line">mkdir workarea-7.0.3</div></div><!-- fragment --><p>We'll get back to this folder when we <a href="../#set-up-a-boss-package">set up a BOSS package</a>.</p>
<p>This is the simple part. Go to the <em>BES file system</em> folder:</p>
<div class="fragment"><div class="line">cd /besfs/users/$USER</div></div><!-- fragment --><p><a href="https://help.github.com/articles/cloning-a-repository/">Clone</a> the <em>BOSS Afterburner</em> repository:</p>
<div class="fragment"><div class="line">git clone https://github.com/redeboer/BOSS_Afterburner</div></div><!-- fragment --><p>The <em>BOSS Aafterburner</em> will be used to analyse output from <b>BOSS</b>. We get back to this in the section <a class="el" href="data-analysis_8md.html">Data analysis</a>. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
